05-1 빠른 CPU를 위한 설계 기법

# 클럭
이전에 공부한 내용을 살펴 보면 
1. 컴퓨터 부품은 '클럭 신호'에 맞춰 일사불란하게 움직인다.
2. CPU는 '명령어 사이클'이라는 정해진 흐름에 맞춰 명령어들을 실행한다.
그렇다면 이 정보에 맞춰 생각해보면 클럭 신호가 빠르게 반복된다면 CPU를 비롯한 컴퓨터 부품들은 그만큼 빠른 박자에 맞춰 움직이고, 그에 따라 명령어 사이클을 더 빠르게 반복할 것이고, 다른 부품들도 그에 맞춰 더 빠르게 작동할 것이다. 실제로도 클럭 속도가 높은 CPU는 일반적으로 성능이 좋다. 그래서 클럭 속도는 CPU 속도 단위로 간주되기도 한다.

**헤르츠**
- 클럭 속도 단위이다.
- 1초에 100번 반복시 100Hz
- 1GHz는 10의 9승 Hz다.
그렇지만 클럭 속도가 무조건 높다고 CPU가 빨라지는 것은 아니다. 클럭 속도를 무작정 높이면 발열 문제가 심각해진다. 클럭 속도만으로 CPU의 성능을 올리는 것에는 한계가 있다.



# 코어와 멀티코어
클럭 속도를 높여 CPU 성능을 높이는 방법 이외에 CPU의 코어와 스레드 수를 늘리는 방법이 있다.

## 코어
CPU의 정의는 명령어를 실행하는 부품이다. 이는 오늘날 코어라는 용어로 사용된다. 예를 들어 8코어는 '명령어를 실행하는 부품'을 여덟 개 포함하고 있다고 보면 된다.


## 멀티코어
코어를 여러 개 포함하고 있는 CPU(2개 이상)를 멀티코어 CPU 또는 멀티코어 프로세서라고 부른다.
연산 속도를 높이는 방법에 코어수를 늘리는 방법도 있다고 말하였는데 마찬가지로 CPU의 연산 속도가 꼭 코어 수에 비례하여 증가하지는 않는다. 조별과제를 빗대어 생각해 본다면 처리할 연산이 적절히 분배되지 않는다면 코어 수에 비례하여 연산 속도가 증가하지는 않는다. 이는 처리하고자 하는 작업량보다 코어 수가 지나치게 많아도 성능에는 크게 영향이 없다. 중요한 것은 코어마다 처리할 명령어들을 얼마나 적절히 분배하느냐 이다.



# 스레드와 멀티스레드
스레드의 사전적 의미는 '실행 흐름의 단위'이다. 일단은 하드웨어적 스레드, 소프트웨어 스레드가 있다고 기억만 하자


## 하드웨어적 스레드
스레드를 하드웨어적으로 정의하면 '하나의 코어가 동시에 처리하는 명령어 단위'를 의미한다. (1코어 = 1스레드)
그런데 여러 스레드를 지원하는 CPU는 하나의 코어로도 여러 개의 명령어를 동시에 실행할 수 있다. 예를 들어 2코어 4스레드 CPU는 명령어를 실행하는 부품을 두 개 포함하고, 한 번에 네 개의 명령어를 처리할 수 있는 CPU를 의미한다. 이와 같이 하나의 코어로 여러 명령어를 동시에 처리하는 CPU를 **멀티스레드 프로세스**, **멀티스레드 CPU**라고 한다.
참고로 하이퍼스레딩이라는 용어를 기억해두자 이는 인텔의 멀티스레드 기술을 의미한다.



## 소프트웨어적 스레드
소프트웨어적으로 정의된 스레드는 '하나의 프로그램에서 독립적으로 실행되는 단위'를 의미한다.
하나의 프로그램은 실행되는 과정에서 한 부분만 실행될 수도 있지만, 프로그램의 여러 부분이 동시에 실행될 수도 있다.
예를 들어 워드 프로세서 프로그램을 개발한다고 가정할 때 아래의 기능이 동시에 수행되길 원한다고 가정해보자
1. 사용자로부터 입력받은 내용을 화면에 보여 주는 기능
2. 사용자가 입력한 내용이 맞춤법에 맞는지 검사하는 기능
3. 사용자가 입력한 내용을 수시로 저장하는 기능
아래와 같이 프로그램을 만든다면 하나의 프로그램에서 여러 부분을 동시에 실행해야 할 것이다. 이와 같은 것이 소프트웨어적 스레드이다.
한 번에 하나씩 명령어를 처리하는 1코어 1스레드 CPU도 소프트웨어적 스레드를 수십 개 실행할 수 있다.(엄청 빠르게 동시에 실행되는 것 처럼)



## 멀티스레드 프로세서
멀티스레드 프로세서는 하나의 코어로 여러 명령어를 동시에 처리하는 CPU라고 했었다. 이런일이 어떻게 가능할까?
가장 큰 핵심은 레지스터이다. 하나의 명령어를 처리하기 위해 꼭 필요한 레지스터를 여러 개 가지고 있으면 된다. 스택 포인터가 두 개 있다면 두 개의 스택을 관리할 수 있는 것 처럼 하나의 코어에 꼭 필요한 레지스터가 두 개가 있다면 CPU는 두 개의 명령어를 처리하기 위한 정보들을 기억할 수 있다.


## 논리 프로세서
하드웨어 스레드를 이용해 하나의 코어로도 여러 명령어를 동시에 처리할 수 있다고 했었다. 그런데 메모리 속 프로그램 입장에서 봤을 때 하드웨어 스레드는 마치 '한 번에 하나의 명령어를 처리하는 CPU'나 다름없다. 2코어 4스레드 CPU는 한 번에 네 개의 명령어를 처리할 수 있는데, 프로그램 입장에서는 한 번에 하나의 명령어를 처리하는 CPU가 네 개 있는 것 처럼 보인다. 그래서 하드웨어 스레드를 논리 프로세서라고도 부른다.
작업 관리잡 탭에서 성능 부분을 보면 코어4에 논리 프로세서8임을 확인 가능하다.

