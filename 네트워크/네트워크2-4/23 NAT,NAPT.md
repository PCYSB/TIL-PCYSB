# 제목 없음

23 NAT/NAPT

# IP 주소를 변환하는 기능

LAN 내부에서의 기기들은 일반적으로 프라이빗 IP 주소를 사용하는데 이는 인터넷에서는 사용할 수없는 주소기 때문에 LAN 내부의 기기가 엑세스하려면 NAT 또는 NAPT를 사용하여 IP 주소를 변환해야 한다

## 할당된 글로벌 IP 주소를 사용하는 NAT(Netowrk Address Translation)

### 1. 로컬 네트워크 내부에서 출발한 패킷

- 로컬 네트워크에 있는 기기가 외부로 통신하기 위해 패킷을 생성한다
- 이 패킷은 로컬 기기의 사설 IP 주소와 포트 번호를 소스로 갖는다

### 2. NAT 장치의 역할

- 로컬 네트워크와 인터넷 간의 중계 역할을 하는 NAT 장치가 이 패킷을 감지한다
- NAT 장치는 로컬 기기의 사설 IP 주소를 자신의 글로벌 IP 주소로 교체한다(가지고 있는 글로벌 IP 주소의 개수만큼만 변환이 가능)
- 또한, 소스 포트 번호를 변경하여 중복을 피하고 통신을 추적할 수 있게 한다

### 3. 인터넷으로 패킷 전송

- 변환된 패킷은 이제 인터넷으로 전송된다
- 외부 네트워크에서는 해당 패킷을 NAT 장치의 글로벌 IP 주소와 포트 번호를 기반으로 인식한다

### 4. 인터넷에서의 응답

- 인터넷에서의 응답 패킷이 로컬 네트워크로 돌아오면, NAT 장치는 이 패킷을 받아서 소스 IP와 포트 번호를 원래의 로컬 기기의 사설 IP와 포트 번호로 변환한다

## TCP/UDP 포트 번호도 이용하는 NAPT(Netowrk Address Port Translation)

NAPT는 주로 사설 네트워크 내의 여러 기기가 하나의 공인 IP 주소를 공유할 때 사용되는 주소 변환 기술이다
NAT와 달리, NAPT는 주소뿐만 아니라 포트 번호도 변환하여 여러 기기가 같은 공인 IP 주소에서 서로 다른 포트 번호를 사용할 수 있도록 한다 이를 통해 여러 기기가 동시에 인터넷에 접속할 수 있으며, 각각을 고유하게 식별할 수 있다

여러 개의 포트 번호를 사용하여 각 기기를 식별할 수 있기 때문에, 가정 내의 여러 디바이스가 동시에 인터넷을 사용할 수 있다