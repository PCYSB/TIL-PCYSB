# 제목 없음

48 FTP

# FTP란?

File Transfer Protocol의 약어로 파일전송 프로토콜이다. 원격지의 서버 혹은 FTP서버가 운영되는 PC에 파일을 업로드를 할 수 있는 공간이다.

## 원리

인터넷 사용 시 HTTP를 사용하는데 간단히 말해 FTP란 파일을 이동할 때 사용하는 프로토콜이다. FTP로 파일을 주고받기 위해서는 FTP서버와 클라이언트가 필요하다. 서버는 주소를 가진 집이라고 하면 클라이언트는 주소를 보고 집을 방문하는 손님으로 이해하면 된다. 집을 드나드는 손님은 파일을 들고 들어가기도 하고, 가지고 나오기도 한다. FTP 클라이언트 프로그램은 집을 드나들 수 있게 해주는 열쇠이자 자동차의 역할을 한다.

## 장점

주로 대량의 파일을 처리할 때 사용되는데 웹 개발 시 유용하다. 여러 개의 파일을 동시에 전송할 수 있고, 연결이 끊긴 경우 전송을 다시 시작할 수 있으며, 전송 일정을 예약할 수 있다.

## 단점

치명적인 단점으로는 보안 부분에서는 상당히 취약하다. 빠른 파일 송수신만을 목적으로 두고 고안되었기 때문에 사이버 보안 조치가 개발된 시기보다 앞선 1970년대에 개발되었기에 보안 프로토콜로 설계된 것이 아니기 때문에 FTP 전송은 파일을 암호화하지 않는다. 그렇기에 데이터 패킷을 캡처하려는 해커들이 패킷 캡처 공격을 통해 비교적 쉽게 비밀번호, 사용자 이름, 그 외 기타 민감한 데이터를 읽을 수 있다.

## Active Mode

① 클라이언트가 서버의 21번 포트로 접속 후 명령을 송수신하기 위해 제어 채널을 생성한다. 이후 사용자가 ls 명령를 입력하면 클라이언트가 사용할  5150 포트(1024 이상의 포트)를 서버에 알려준다.
② 서버는 이에 대해 Ack로 응답한다.
③ 서버의 20번 포트는 클라이언트가 알려준 두 번째 포트로 접속 후 데이터 채널을 생성한다.
④ 마지막으로 클라이언트가 Ack로 응답한다.

서버에서 클라이언트로 요청을 하기 때문에 클라이언트 PC에 방화벽이 설치되어 외부에서의 접속을 허용하지 않는다면 FTP 접속은 되지만 이후 데이터 채널 연결이 불가능하여 파일을 받을 수 없는 문제가 발생할 수 있다.

## Pssive Mode

① 클라이언트의 서버의 21번 포트로 접속 후 제어 채널을 생성한다. 이후 사용자가 명령어를 입력하면 클라이언트는 Passive Mode로 연결하기 위해 PASV명령어를 전송한다.
② 서버에서는 서버가 사용할 3267포트(1024 이상의 포트)를 알려준다.
③ 클라이언트는 서버가 알려준 포트번호로 접속을 시도하여 데이터 채널을 생성한다.
④ 서버는 Ack로 응답한 후 데이터를 송신한 후 데이터 채널 연결을 종료한다.

두 번째 data포트로서 active 모드가 사용했던 20번을 사용하지 않고 대신 1024 이후의 임의의 비 특권 포트를 사용한다.

서버에서 포트번호를 알려주기 때문에,  해당 대역의 방화벽 포트를 열어 두어야 한다.

대부분의 웹브라우저는 [ftp://를](ftp://xn--bx2b/) 이용하여 FTP에 접속할 때 수동모드만 지원한다.

# 새로운 대안 SFTP

FTP의 대안 중 하나로는 SFTP가 있다. SFTP는 SSH 데이터 스트림을 통해 보안 등급이 높은 파일 전송을 실현하는 별도의 프로토콜로 SSH와 같은 방식을 사용한다.

## 장점

- SFTP는 하나의 연결만 필요하며 데이터 연결이 필요하지 않다.
- 연결이 안전하게 보호된다.
- SFTP는 기계를 읽을 수 있고 균일한 디렉토리 목록을 자랑합니다.
- 프로토콜에서 제공하는 추가 기능에는 파일 잠금, 속성 조작, 권한 작업 및 더 많은 기능이 포함됩니다.