09-2 운영체제의 큰 그림

# 커널
운영체제는 현존하는 가장 큰 프로그램중 하나이다. 그에따라 운영체제 서비스 또한 매우 다양하다.
자원에 접근하고 조작하는 기능, 프로그램이 올바르고 안전하게 실행되게 하는 기능이 운영체제의 핵심 서비스이다.
이러한 운영체제의 핵심 서비스를 담당하는 부분을 **커널(kernel)**이라고 한다.
운영체제가 설치된 모든 기기에는 커널이 있다.

## 사용자 인터페이스(UI)
운영체제가 제공하는 서비스 중 커널에 포함되지 않는 서비스이다.
**그래픽 유저 인터페이스**, **커맨드 라인 인터페이스**가 있다.

### 그래픽 유저 인터페이스
윈도우 바탕화면이나 스마트폰의 화면처럼 그래픽을 기반으로 컴퓨터와 상호작용할 수 있는 인터페이스
우리가 흔히 사용하는 스마트폰 화면이나 웹 에서는 그래픽 유저 인터페이스를 지원하기에 우리가 편하게 화면을 보고 프로그램을 이용할 수 있는 것이다.

### 커맨드 라인 인터페이스 
명령어를 기반으로 컴퓨터와 상호작용할 수 있는 인터페이스
명령어를 기반으로 컴퓨터와 상호작용하는 인터페이스, 아이콘이나 다채로운 그래픽 화면은 없다.
정해진 명령어를 입력함으로써 컴퓨터와 상호작용할 수 있다.


> - 가장 큰 프로그램중 하나라고 하였는데 대표적인 운영체제인 리눅스를 구성하는 코드의 경우 2700만 줄이 넘어간다.
> - 대부분의 운영체제 전공서는 운영체제의 핵심부, 커널을 설명한다.(그만큼 중요하다는 얘기)


# 이중 모드
운영체제는 사용자가 실행하는 응용 프로그램이 하드웨어 자원에 직접 접근하는 것을 방지하여 자원을 보호한다.
운영체제의 문지기 역할은 이중 모드로서 구현된다.
**이중 모드**란 CPU가 명령어를 실행하는 모드를 크게 사용자 모드와 커널 모드로 구분하는 방식이다.

> - 만약 응용프로그램이 직접 자원에 접근할 수 있다면 자원은 무질서 하게 관리될 것이고 응용 프로그램이 조금만 실수해도 컴퓨터 전체에 큰 악영향을 끼칠 수 있다.
> - 운영체제는 응용 프로그램들이 자원에 접근하려고 할 때 오직 자신을 통해서만 접근하도록 한다.(일종의 자원 접근 대행 문지기 역할)


## 사용자 모드
운영체제 서비스를 제공받을 수 없는 실행모드 (커널 영역의 코드를 실행할 수 없는 모드)


> - 일반적인 응용 프로그램은 기본적으로 사용자 모드로 실행된다.
> - 사용자 모드로 실행 중인 CPU는 입출력 명령어와 같이 하드웨어 자원에 접근하는 명령어를 실행할 수 없다.

# 커널 모드
운영체제 서비스를 제공받을 수 있는 실행 모드, 커널 영역의 코드를 실행할 수 있는 모드이다.
사용자 모드로 실행되는 프로그램이 자원에 접근하는 운영체제 서비스를 제공받으려면 운영체제에 요청을 보내 커널 모드로 전환되어야한다.


> - CPU가 커널 모드로 명령어를 실행시 자원에 접근하는 명령어를 비롯한 모든 명령어를 실행할 수 있다.
> - 운영체제는 커널 모드로 실행되기 때문에 자원에 접근할 수 있다.
> - 사용자 모드로 실행되는 프로그램이 자원에 접근하는 운영체제 서비스를 제공받으려면 **운영체제에 요청을 보내**커널 모드로 전환되어야한다.

# 시스템 호출
운영체제 서비스를 제공받기 위한 요청
시스템 호출은 특정 명령어에 의해 발생하는 **소프트웨어 인터럽트**이다.

> - 시스템 호출은 일종의 인터럽트이다.
> - CPU가 시스템 호출을 처리하는 순서: CPU는 지금까지의 작업을 백업, 커널 영역 내에 시스템 호출을 수행하는 코드(인터럽트 서비스 루틴) 실행, 다시 기존에 실행하던 응용프로그램으로 복귀하여 실행
> - 일반적으로 매우 빈번히 발생 빈번히 사용자 모드와 커널 모드를 오가며 실행



# 운영체제의 핵심 서비스
운영체제의 핵심 서비스는 프로세스 관리, 자원 접근 및 할당, 파일 시스템 관리 이다.


## 프로세스 관리
실행중인 프로그램을 프로세스라고 한다.


> - 작업관리자를 열어 프로세스 항목을 통해 어떤 프로세스가 실행 중인지 알 수 있다.
> - 운영체제는 다양한 프로세스를 일목요연하게 관리하고 실행할 수 있어야한다.
> - 여러 프로세스가 동시에 실행되는 환경에서는 '프로세스 동기화'가 필수적이고 프로세스의 '교착 상태'를 해결해야 한다.


## 자원 접근 및 할당
운영체제는 프로세스들이 사용할 자원에 접근하고 조작함으로써 프로세스에 필요한 자원을 할당해 준다.
밑 에서는 운영체제가 어떻게 자원을 관리하고 어떤 기능을 제공하는지 알아볼 것이다.

### CPU
하나의 CPU는 한 번에 하나의 프로세스만 실행이 가능하다. 그동안 다른 프로세스들은 기다리고 있어야한다.
운영체제는 프로세스들에 공정하게 CPU를 할당하기 위해 어떤 프로세스부터 CPU를 이용하게 할 것인지, 얼마나 오래 CPU를 이용하게 할지를 결정할 수 있어야 한다. 이를 **CPU 스케줄링**이라고 한다.

> 쉽게 말해 프로세들에 CPU를 적절히 이용시킬수 있도록 CPU 스케줄링을 잘 해야 된다.


### 메모리
시시가각 변하는 메모리에 적재된 프로세스들을 관리하기 위해 운영체제는 새로운 프로세스가 적재될 때마다 어느 주소에 어떻게 적재해야 할지를 결정해야 한다.


### 입출력 장치
인터럽트 서비스 루틴은 운영체제가 제공하는 기능으로 커널 영역에 있다.
하드웨어 인터럽트도 마찬가지이다.

> 이 과정은 시스템 호출의 과정과 비슷하다.


## 파일 시스템 관리
우리가 흔히 사용하는 파일들과 그 파일을 묶은 디렉토리로 관리한다. 이런 시스템도 운영체제가 관리


# 정리
> - 커널은 운영체제의 핵심 서비스를 담당하는 부분
> - 운영체제가 제공하는 서비스중 커널에 포함되지 않는 서비스는 그래픽 유저 인터페이스, 커맨드 라인 인터페이스
> - 응용 프로그램은 자원 접근 x 운영체제를 통해서만 접근 가능
> - 이 보호를 이중 모드로서 구현 -> **사용자 모드, 커널 모드**로 나누어짐 이때 **커널 모드**로 변경하기 위해 사용하는 것이 **시스템 호출**
> - 운영체제의 핵심 서비스는 1. 프로세스 관리 2. 자원 접근 및 할당, 3. 파일 시스템 관리