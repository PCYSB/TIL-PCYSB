10-3 스레드

# 프로세스와 스레드
프로세스는 실행되는 프로그램
스레드는 프로세스를 구성하는 실행의 흐름 단위

> - '실행의 흐름 단위가 하나'라는 점에서 이렇게 실행되는 프로세스들은 **단일 스레드 프로세스**
> - **스레드**라는 개념이 도입되면서 하나의 프로세스가 한 번에 여러 일을 동시에 처리할 수 있게 되었다.
> - 즉 프로세스를 구성하는 여러 명령어를 동시에 실행할 수 있게 된 것이다.
> - 스레드는 프로세스 내에서 각기 다른 스레드 ID, 프로그램 카운터 값을 비롯한 레지스터 값, 스택으로 구성된다.
> - 그렇기에 스레드마다 각기 다른 코드를 실행할 수 있다. 

![alt text](<스크린샷 2024-03-25 180937.png>)

> - 스레드들은 실행에 필요한 최소한의 정보만을 유지한 채 **프로세스 자원을 공유**하며 실행된다.

> 리눅스의 경우 스레드와 프로세스를 따로 구분 짓지 않는다. 대신 **태스크**라는 이름으로 통일하여 명명한다. 리눅스에서는 프로세스와 스레드는 그냥 "실행의 문맥"으로 본다.

# 멀티프로세스와 멀티스레드
**여러 프로세스**를 동시에 실행하는 것을 **멀티프로세스**라고 한다.
여러 스레드로 프로세스를 동시에 실행하는 것을 **멀티스레드**라고 한다.

> - 한 프로세스를 이루는 스레드는 여러 개 있을 수 있다.
> - 여러 프로세스는 동시에 실행될 수 있다.


### 단일 스레드 프로세스 여러개 vs 하나의 프로세스 여러 스레드
"hello, os"를 세 번 출력하는 간단한 프로그램이 있다고 할 때
1. 단일 스레드 프로세스 여러개
2. 하나의 프로세스 여러 스레드

![alt text](<스크린샷 2024-03-25 181826.png>)

> - 결과적으로는 "hello, os"가 세 번 출력이 될 것이다.
> - 결과는 같지만 여기에는 큰 차이가 있다. 
> - 프로세스끼리는 기본적으로 자원을 공유하지 않는다.
> - 스레드끼리는 같은 프로세스 내의 자원을 공유한다.

**단일 스레드 프로세스 여러개**
- 프로세스 fork하여 동일한 프로세스를 동시에 실행, PID, 저장된 메모리 주소를 제외하면 모든 것이 동일한 프로세스 두 개가 통째로 메모리에 적재 된다.
- 어찌 보면 메모리 공간을 낭비(같은 프로그램을 실행하기 위해 메모리에 동일한 내용들이 중복해서 존재)

**여러 스레드**
![alt text](<스크린샷 2024-03-25 182243.png>)
- 다른 스레드 ID, 프로그램 카운터 값을 포함한 레지스터 값, 스택을 가질 뿐 프로세스가 가진 자원을 공유
- 이는 단점이 될 수도 있는데 멀티프로세스 환경에서는 프로세스 하나에 문제가 생겨도 지장이 적거나 없다.
- 멀티스레드 환경에서는 하나의 스레드에 문제가 생기면 프로세스 전체에 문제가 생길 수 있다.(프로세스의 자원을 공유하기 때문)


# 정리
- 단일 스레드 프로세스 -> 스레드 하나
- 멀티 스레드 프로세스 -> 스레드 여러개
- 스레드 -> 프로세스 내에서 구성